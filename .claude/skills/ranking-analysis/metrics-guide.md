# 순위 분석 메트릭 가이드

네이버 쇼핑 상품 순위 분석에 사용되는 주요 메트릭과 해석 방법을 설명합니다.

## 목차
1. [기본 통계 메트릭](#기본-통계-메트릭)
2. [효과성 메트릭](#효과성-메트릭)
3. [안정성 메트릭](#안정성-메트릭)
4. [비교 메트릭](#비교-메트릭)
5. [시간 메트릭](#시간-메트릭)

---

## 기본 통계 메트릭

### 1. 평균 순위 변동 (Mean Rank Change)

**정의**: 모든 테스트의 순위 변동을 평균한 값

**계산식**:
```
평균 = Σ(순위 변동) / 테스트 횟수
```

**해석**:
- 양수(+): 순위 상승 (좋음)
- 음수(-): 순위 하락 (나쁨)
- 0: 변동 없음

**목표값**: +10위 이상

**예시**:
```
테스트 결과: +12, -3, +18, +5, +8
평균: (12-3+18+5+8) / 5 = +8.0위
```

### 2. 중앙값 (Median)

**정의**: 순위 변동을 오름차순으로 정렬했을 때 중간값

**장점**: 이상치의 영향을 덜 받음

**예시**:
```
테스트 결과: +5, +8, +12, +18, +68
중앙값: +12위 (3번째 값)

평균: +22.2위 (이상치 +68의 영향)
→ 중앙값이 더 대표성 있음
```

### 3. 표준편차 (Standard Deviation)

**정의**: 순위 변동의 산포도 (흩어진 정도)

**계산식**:
```
σ = √[Σ(x - μ)² / n]
```

**해석**:
- 낮은 표준편차 (< 10): 일관된 효과
- 중간 표준편차 (10~20): 보통
- 높은 표준편차 (> 20): 불안정한 효과

**예시**:
```
케이스 A: +15, +16, +14, +17, +15
표준편차: 1.14 (매우 안정적)

케이스 B: +25, -5, +10, +30, -10
표준편차: 17.68 (불안정)
```

### 4. 사분위수 (Quartiles)

**정의**: 데이터를 4등분하는 값

- **Q1 (25th percentile)**: 하위 25%
- **Q2 (50th percentile)**: 중앙값
- **Q3 (75th percentile)**: 상위 25%
- **IQR**: Q3 - Q1 (사분위 범위)

**활용**: 박스플롯 생성, 이상치 탐지

---

## 효과성 메트릭

### 1. 성공률 (Success Rate)

**정의**: 순위가 상승한 테스트의 비율

**계산식**:
```
성공률 = (순위 상승 횟수) / (총 테스트 횟수) × 100%
```

**목표값**: 85% 이상

**예시**:
```
총 100회 테스트 중 89회 순위 상승
성공률: 89%
```

### 2. 페이지 이동률 (Page Move Rate)

**정의**: 페이지 간 이동이 발생한 테스트의 비율

**계산식**:
```
페이지 이동률 = (페이지 이동 발생 횟수) / (총 테스트 횟수) × 100%
```

**예시**:
```
페이지 3 → 페이지 2: 페이지 이동 발생
페이지 3, 위치 12 → 페이지 3, 위치 5: 페이지 이동 없음
```

### 3. 목표 달성률 (Goal Achievement Rate)

**정의**: 설정한 목표(예: +10위 이상)를 달성한 테스트의 비율

**계산식**:
```
목표 달성률 = (목표 달성 횟수) / (총 테스트 횟수) × 100%
```

**예시**:
```
목표: +10위 이상 상승
100회 테스트 중 67회 +10위 이상 달성
목표 달성률: 67%
```

---

## 안정성 메트릭

### 1. 안정성 지수 (Stability Index)

**정의**: 평균 대비 표준편차의 비율

**계산식**:
```
안정성 지수 = 평균 / 표준편차
```

**해석**:
- 높음 (> 1.5): 매우 안정적
- 보통 (0.5~1.5): 보통
- 낮음 (< 0.5): 불안정

**예시**:
```
평균: +15위, 표준편차: 8
안정성 지수: 15 / 8 = 1.88 (안정적)

평균: +12위, 표준편차: 18
안정성 지수: 12 / 18 = 0.67 (보통)
```

### 2. 변동 계수 (Coefficient of Variation, CV)

**정의**: 표준편차를 평균으로 나눈 값 (%)

**계산식**:
```
CV = (표준편차 / 평균) × 100%
```

**해석**:
- 낮음 (< 30%): 안정적
- 보통 (30~50%): 보통
- 높음 (> 50%): 불안정

**장점**: 다른 스케일의 데이터 비교 가능

### 3. 순위 변동 범위 (Range)

**정의**: 최대값과 최소값의 차이

**계산식**:
```
범위 = 최대 순위 변동 - 최소 순위 변동
```

**예시**:
```
최대: +68위, 최소: -12위
범위: 68 - (-12) = 80위 (매우 넓음)
```

---

## 비교 메트릭

### 1. 평균 차이 (Mean Difference)

**정의**: 두 그룹 간 평균 순위 변동의 차이

**계산식**:
```
평균 차이 = 평균(그룹 A) - 평균(그룹 B)
```

**예시**:
```
케이스 A 평균: +15.2위
케이스 B 평균: +9.6위
평균 차이: +5.6위 (케이스 A가 더 효과적)
```

### 2. 효과 크기 (Effect Size, Cohen's d)

**정의**: 두 그룹 간 표준화된 차이

**계산식**:
```
Cohen's d = (평균1 - 평균2) / Pooled SD
```

**해석**:
- 작음 (0.2): 약간의 차이
- 중간 (0.5): 명확한 차이
- 큼 (0.8+): 매우 큰 차이

**예시**:
```
케이스 A: 평균 +15, SD 5
케이스 B: 평균 +9, SD 6
Cohen's d ≈ 1.05 (큰 효과)
```

### 3. p-value (통계적 유의성)

**정의**: 귀무가설이 참일 확률

**해석**:
- p < 0.05: 통계적으로 유의함 (95% 신뢰)
- p < 0.01: 매우 유의함 (99% 신뢰)
- p ≥ 0.05: 유의하지 않음

**예시**:
```
t-test 결과: p = 0.023
→ 두 케이스 간 차이가 통계적으로 유의함
```

### 4. 신뢰구간 (Confidence Interval, CI)

**정의**: 모집단 평균이 포함될 것으로 예상되는 범위

**계산식 (95% CI)**:
```
CI = 평균 ± 1.96 × (표준편차 / √n)
```

**예시**:
```
평균: +12위, SD: 8, n: 100
95% CI: 12 ± 1.57 = [10.43, 13.57]
→ 95% 확률로 실제 평균이 10.43~13.57위 사이
```

---

## 시간 메트릭

### 1. 시간대별 평균 (Time-of-Day Average)

**정의**: 특정 시간대의 평균 순위 변동

**분류**:
- 오전 (06:00~12:00)
- 오후 (12:00~18:00)
- 저녁 (18:00~24:00)
- 심야 (00:00~06:00)

**예시**:
```
오전: +14.2위
오후: +11.8위
저녁: +10.5위
심야: +13.1위
→ 오전이 가장 효과적
```

### 2. 요일별 평균 (Day-of-Week Average)

**정의**: 특정 요일의 평균 순위 변동

**비교**: 주중 vs 주말

**예시**:
```
주중 평균: +13.1위
주말 평균: +10.8위
차이: +2.3위 (주중이 더 효과적)
```

### 3. 누적 효과 (Cumulative Effect)

**정의**: 시간에 따른 누적 순위 변동

**계산식**:
```
누적 순위 변동 = Σ(순위 변동)
```

**활용**: 장기 트렌드 파악

**예시**:
```
1일차: +12위 → 누적 +12위
2일차: +8위 → 누적 +20위
3일차: -3위 → 누적 +17위
...
```

---

## 메트릭 해석 가이드

### 좋은 결과 기준

| 메트릭 | 목표값 | 우수 | 양호 | 개선 필요 |
|--------|--------|------|------|-----------|
| 평균 순위 변동 | +10위 | +15위 이상 | +10~15위 | +10위 미만 |
| 성공률 | 85% | 90% 이상 | 85~90% | 85% 미만 |
| 안정성 지수 | 1.0 | 1.5 이상 | 1.0~1.5 | 1.0 미만 |
| 표준편차 | - | 10 미만 | 10~20 | 20 초과 |
| Cohen's d | 0.5 | 0.8 이상 | 0.5~0.8 | 0.5 미만 |

### 의사결정 기준

#### 케이스 선택 (A vs B)
```
IF 평균 차이 > 5위 AND p < 0.05 AND Cohen's d > 0.5:
    → 더 효과적인 케이스 선택
ELIF 평균 차이 < 2위 OR p ≥ 0.05:
    → 차이 없음, 비용/편의성 고려
ELSE:
    → 추가 테스트 필요
```

#### 테스트 횟수 결정
```
IF 안정성 지수 > 1.5:
    → 50회 테스트로 충분
ELIF 안정성 지수 < 1.0:
    → 100회 이상 권장
ELSE:
    → 70~100회 권장
```

#### 시간대 선택
```
IF 시간대 간 평균 차이 > 3위 AND p < 0.05:
    → 가장 효과적인 시간대 집중
ELSE:
    → 시간대 상관없이 균등 분배
```

---

## 실전 예제

### 예제 1: 케이스 비교

**데이터**:
- 케이스 A: 평균 +15.2위, SD 8.5, n=100, 성공률 89%
- 케이스 B: 평균 +9.6위, SD 12.3, n=100, 성공률 76%

**분석**:
1. 평균 차이: +5.6위 (케이스 A 우세)
2. t-test: p = 0.002 (통계적으로 유의)
3. Cohen's d: 0.52 (중간 효과 크기)
4. 성공률 차이: 13% (유의함)

**결론**: 케이스 A가 케이스 B보다 명확하게 더 효과적

**권장 사항**: 케이스 A를 주요 전략으로 채택 (70% 비중)

### 예제 2: 시간대 최적화

**데이터**:
| 시간대 | 평균 | SD | 테스트 횟수 | 성공률 |
|--------|------|-----|-------------|--------|
| 오전 | +14.2 | 9.1 | 120 | 91% |
| 오후 | +11.8 | 11.5 | 150 | 88% |
| 저녁 | +10.5 | 13.2 | 110 | 85% |
| 심야 | +13.1 | 10.8 | 70 | 87% |

**분석**:
1. 오전이 가장 높은 평균 (+14.2위)
2. 오전이 가장 안정적 (SD 9.1)
3. 오전이 가장 높은 성공률 (91%)
4. 심야도 효과적이나 테스트 횟수 적음

**결론**: 오전 시간대가 최적

**권장 사항**:
- 오전 테스트 비중 확대 (40% → 50%)
- 심야 추가 테스트로 검증 (70회 → 100회)

### 예제 3: 안정성 평가

**데이터**:
- 상품 A: 평균 +18위, SD 7.2, 안정성 지수 2.5
- 상품 B: 평균 +12위, SD 18.4, 안정성 지수 0.65

**분석**:
1. 상품 A: 높은 효과 + 높은 안정성 (이상적)
2. 상품 B: 중간 효과 + 낮은 안정성 (위험)

**결론**:
- 상품 A: 50회 테스트로 충분, 즉시 적용 가능
- 상품 B: 100회 이상 테스트 필요, 전략 재검토

**권장 사항**:
- 상품 A는 테스트 완료 후 실전 배포
- 상품 B는 추가 테스트 및 케이스 변경 검토

---

## 메트릭 계산 도구

### Python 함수

```python
def calculate_all_metrics(rank_changes):
    """
    모든 주요 메트릭을 한 번에 계산합니다.
    """
    import numpy as np

    metrics = {
        # 기본 통계
        'mean': np.mean(rank_changes),
        'median': np.median(rank_changes),
        'std': np.std(rank_changes),
        'min': np.min(rank_changes),
        'max': np.max(rank_changes),
        'range': np.max(rank_changes) - np.min(rank_changes),

        # 사분위수
        'q1': np.percentile(rank_changes, 25),
        'q3': np.percentile(rank_changes, 75),
        'iqr': np.percentile(rank_changes, 75) - np.percentile(rank_changes, 25),

        # 효과성
        'success_rate': sum(1 for x in rank_changes if x > 0) / len(rank_changes),

        # 안정성
        'stability_index': np.mean(rank_changes) / np.std(rank_changes) if np.std(rank_changes) > 0 else float('inf'),
        'cv': (np.std(rank_changes) / np.mean(rank_changes) * 100) if np.mean(rank_changes) > 0 else 0,

        # 메타데이터
        'total_count': len(rank_changes)
    }

    return metrics
```

---

## 참고 자료

- [통계 기초 개념](https://en.wikipedia.org/wiki/Statistics)
- [Cohen's d 계산](https://en.wikipedia.org/wiki/Effect_size#Cohen's_d)
- [t-test 이해](https://en.wikipedia.org/wiki/Student%27s_t-test)
- [신뢰구간 계산](https://en.wikipedia.org/wiki/Confidence_interval)

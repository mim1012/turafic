# ë´‡ë³„ ì‘ì—… í• ë‹¹ ì „ëµ ë° ìˆœìœ„ ë³€í™” ê°ì§€ ì‹œìŠ¤í…œ

**ì‘ì„±ì¼**: 2025-11-05  
**ë²„ì „**: 1.0  
**ëª©ì **: 22ê°œ ë´‡ì˜ ì‘ì—… í• ë‹¹ ì „ëµ ë° ìˆœìœ„ ë³€í™” ê°ì§€ ì‹œ ìœ ì˜ë¯¸í•œ ë³€ìˆ˜ ì €ì¥ ë° ë³„ë„ í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œ ì„¤ê³„

---

## ğŸ¯ í•µì‹¬ ëª©í‘œ

1. âœ… **ë´‡ë³„ ì‘ì—… í• ë‹¹**: ìˆœìœ„ ì²´í¬ vs íŠ¸ë˜í”½ ìƒì„±, ë„¤ì´ë²„ vs ì¿ íŒ¡
2. âœ… **ìˆœìœ„ ë³€í™” ê°ì§€**: ìœ ì˜ë¯¸í•œ ìˆœìœ„ ë³€í™” ìë™ ê°ì§€
3. âœ… **ë³€ìˆ˜ ì €ì¥**: ìœ ì˜ë¯¸í•œ ë³€ìˆ˜ ìë™ ì €ì¥
4. âœ… **ë³„ë„ í…ŒìŠ¤íŠ¸**: ì €ì¥ëœ ë³€ìˆ˜ë¡œ ë³„ë„ í…ŒìŠ¤íŠ¸ ìë™ ì‹¤í–‰

---

## ğŸ“Š 22ê°œ ë´‡ êµ¬ì„±

### ì „ì²´ êµ¬ì„±

| ë´‡ ìœ í˜• | ìˆ˜ëŸ‰ | APK | ì—­í•  |
|---------|------|-----|------|
| **ëŒ€ì¥ ë´‡** | 6ê°œ | zu12.apk | í•«ìŠ¤íŒŸ ì œê³µ |
| **ì«„ë³‘ ë´‡** | 12ê°œ | zcu12.apk | í•«ìŠ¤íŒŸ ì—°ê²°, íŠ¸ë˜í”½ ìƒì„± |
| **ìˆœìœ„ ì²´í¬ ë´‡** | 4ê°œ | zru12.apk | ìˆœìœ„ ëª¨ë‹ˆí„°ë§ |
| **ì´ê³„** | **22ê°œ** | - | - |

---

### ê·¸ë£¹ êµ¬ì„±

```
ê·¸ë£¹ 1 (íŠ¸ë˜í”½ ìƒì„±)
â”œâ”€ zu12 (ëŒ€ì¥) - Device 1
â”œâ”€ zcu12 (ì«„ë³‘ 1) - Device 2
â””â”€ zcu12 (ì«„ë³‘ 2) - Device 3

ê·¸ë£¹ 2 (íŠ¸ë˜í”½ ìƒì„±)
â”œâ”€ zu12 (ëŒ€ì¥) - Device 4
â”œâ”€ zcu12 (ì«„ë³‘ 1) - Device 5
â””â”€ zcu12 (ì«„ë³‘ 2) - Device 6

ê·¸ë£¹ 3 (íŠ¸ë˜í”½ ìƒì„±)
â”œâ”€ zu12 (ëŒ€ì¥) - Device 7
â”œâ”€ zcu12 (ì«„ë³‘ 1) - Device 8
â””â”€ zcu12 (ì«„ë³‘ 2) - Device 9

ê·¸ë£¹ 4 (íŠ¸ë˜í”½ ìƒì„±)
â”œâ”€ zu12 (ëŒ€ì¥) - Device 10
â”œâ”€ zcu12 (ì«„ë³‘ 1) - Device 11
â””â”€ zcu12 (ì«„ë³‘ 2) - Device 12

ê·¸ë£¹ 5 (íŠ¸ë˜í”½ ìƒì„±)
â”œâ”€ zu12 (ëŒ€ì¥) - Device 13
â”œâ”€ zcu12 (ì«„ë³‘ 1) - Device 14
â””â”€ zcu12 (ì«„ë³‘ 2) - Device 15

ê·¸ë£¹ 6 (íŠ¸ë˜í”½ ìƒì„±)
â”œâ”€ zu12 (ëŒ€ì¥) - Device 16
â”œâ”€ zcu12 (ì«„ë³‘ 1) - Device 17
â””â”€ zcu12 (ì«„ë³‘ 2) - Device 18

ìˆœìœ„ ì²´í¬ ê·¸ë£¹
â”œâ”€ zru12 - Device 19
â”œâ”€ zru12 - Device 20
â”œâ”€ zru12 - Device 21
â””â”€ zru12 - Device 22
```

---

## ğŸ”„ ì‘ì—… í• ë‹¹ ì „ëµ

### ì‹œë‚˜ë¦¬ì˜¤ 1: ë„¤ì´ë²„ ìˆœìœ„ ì²´í¬

**ëª©ì **: ë„¤ì´ë²„ ì‡¼í•‘ì—ì„œ ì œí’ˆ ìˆœìœ„ í™•ì¸

**í• ë‹¹**:
- **ìˆœìœ„ ì²´í¬ ë´‡ 4ê°œ** (Device 19~22)
- **íŠ¸ë˜í”½ ìƒì„± ë´‡ 0ê°œ**

**ì›Œí¬í”Œë¡œìš°**:
```
ì‚¬ìš©ì ì…ë ¥
   â†“
{
  "platform": "naver",
  "task_type": "rank_check",
  "keyword": "ì‚¼ì„± ê°¤ëŸ­ì‹œ S24",
  "product_id": "12345678"
}
   â†“
Control Tower Agent
   â”œâ”€ L18 ë³€ìˆ˜ ì¡°í•© ìƒì„± (4ê°œ, ìˆœìœ„ ì²´í¬ìš©)
   â”œâ”€ JSON íŒ¨í„´ ìƒì„± (4ê°œ)
   â””â”€ Device 19~22ì—ê²Œ í• ë‹¹
   â†“
ìˆœìœ„ ì²´í¬ ë´‡ ì‹¤í–‰
   â”œâ”€ Device 19: íŒ¨í„´ 1
   â”œâ”€ Device 20: íŒ¨í„´ 2
   â”œâ”€ Device 21: íŒ¨í„´ 3
   â””â”€ Device 22: íŒ¨í„´ 4
   â†“
ê²°ê³¼ ìˆ˜ì§‘
   â”œâ”€ Device 19: ìˆœìœ„ 7ìœ„
   â”œâ”€ Device 20: ìˆœìœ„ 7ìœ„
   â”œâ”€ Device 21: ìˆœìœ„ 8ìœ„
   â””â”€ Device 22: ìˆœìœ„ 7ìœ„
   â†“
í‰ê·  ìˆœìœ„: 7.25ìœ„
```

---

### ì‹œë‚˜ë¦¬ì˜¤ 2: ë„¤ì´ë²„ íŠ¸ë˜í”½ ìƒì„±

**ëª©ì **: ë„¤ì´ë²„ ì‡¼í•‘ì—ì„œ íŠ¸ë˜í”½ ìƒì„±í•˜ì—¬ ìˆœìœ„ ê°œì„ 

**í• ë‹¹**:
- **íŠ¸ë˜í”½ ìƒì„± ë´‡ 18ê°œ** (Device 1~18)
- **ìˆœìœ„ ì²´í¬ ë´‡ 4ê°œ** (Device 19~22, 30ë¶„ë§ˆë‹¤ ìˆœìœ„ í™•ì¸)

**ì›Œí¬í”Œë¡œìš°**:
```
ì‚¬ìš©ì ì…ë ¥
   â†“
{
  "platform": "naver",
  "task_type": "traffic",
  "keyword": "ì‚¼ì„± ê°¤ëŸ­ì‹œ S24",
  "product_id": "12345678",
  "target_count": 100  // 100íšŒ íŠ¸ë˜í”½ ìƒì„±
}
   â†“
Control Tower Agent
   â”œâ”€ L18 ë³€ìˆ˜ ì¡°í•© ìƒì„± (18ê°œ, íŠ¸ë˜í”½ ìƒì„±ìš©)
   â”œâ”€ JSON íŒ¨í„´ ìƒì„± (18ê°œ)
   â””â”€ Device 1~18ì—ê²Œ í• ë‹¹
   â†“
íŠ¸ë˜í”½ ìƒì„± ë´‡ ì‹¤í–‰ (15ë¶„ ê°„ê²©, 2ê·¸ë£¹ êµì°¨)
   â”œâ”€ 0ë¶„: ê·¸ë£¹ 1, 3, 5 ì‹¤í–‰ (Device 1~3, 7~9, 13~15)
   â”œâ”€ 5ë¶„: í•«ìŠ¤íŒŸ ì¬ì‹œì‘ (ëª¨ë“  ëŒ€ì¥ ë´‡)
   â”œâ”€ 15ë¶„: ê·¸ë£¹ 2, 4, 6 ì‹¤í–‰ (Device 4~6, 10~12, 16~18)
   â”œâ”€ 20ë¶„: í•«ìŠ¤íŒŸ ì¬ì‹œì‘
   â””â”€ 30ë¶„: ìˆœìœ„ ì²´í¬ (Device 19~22)
   â†“
ìˆœìœ„ ë³€í™” ê°ì§€
   â”œâ”€ 0ë¶„: 7.25ìœ„ (ì´ˆê¸°)
   â”œâ”€ 30ë¶„: 6.50ìœ„ (ê°œì„  +0.75ìœ„) â­
   â”œâ”€ 60ë¶„: 5.75ìœ„ (ê°œì„  +1.50ìœ„) â­â­
   â””â”€ 90ë¶„: 5.00ìœ„ (ê°œì„  +2.25ìœ„) â­â­â­
   â†“
ìœ ì˜ë¯¸í•œ ë³€ìˆ˜ ì €ì¥ (ìˆœìœ„ ê°œì„  > 1ìœ„)
   â”œâ”€ user_agent: Samsung 24.0
   â”œâ”€ cookie_index: 100
   â”œâ”€ scroll_count: 6
   â””â”€ between_wait: 1900ms
```

---

### ì‹œë‚˜ë¦¬ì˜¤ 3: ì¿ íŒ¡ ìˆœìœ„ ì²´í¬

**ëª©ì **: ì¿ íŒ¡ì—ì„œ ì œí’ˆ ìˆœìœ„ í™•ì¸

**í• ë‹¹**:
- **ìˆœìœ„ ì²´í¬ ë´‡ 4ê°œ** (Device 19~22)
- **íŠ¸ë˜í”½ ìƒì„± ë´‡ 0ê°œ**

**ì›Œí¬í”Œë¡œìš°**:
```
ì‚¬ìš©ì ì…ë ¥
   â†“
{
  "platform": "coupang",
  "task_type": "rank_check",
  "keyword": "ì‚¼ì„± ê°¤ëŸ­ì‹œ S24",
  "product_id": "1234567890"
}
   â†“
Control Tower Agent
   â”œâ”€ L18 ë³€ìˆ˜ ì¡°í•© ìƒì„± (4ê°œ, ìˆœìœ„ ì²´í¬ìš©)
   â”œâ”€ JSON íŒ¨í„´ ìƒì„± (4ê°œ, ì¿ íŒ¡ CSS Selector ì‚¬ìš©)
   â””â”€ Device 19~22ì—ê²Œ í• ë‹¹
   â†“
ìˆœìœ„ ì²´í¬ ë´‡ ì‹¤í–‰
   â”œâ”€ Device 19: íŒ¨í„´ 1
   â”œâ”€ Device 20: íŒ¨í„´ 2
   â”œâ”€ Device 21: íŒ¨í„´ 3
   â””â”€ Device 22: íŒ¨í„´ 4
   â†“
ê²°ê³¼ ìˆ˜ì§‘
   â”œâ”€ Device 19: ìˆœìœ„ 12ìœ„
   â”œâ”€ Device 20: ìˆœìœ„ 12ìœ„
   â”œâ”€ Device 21: ìˆœìœ„ 13ìœ„
   â””â”€ Device 22: ìˆœìœ„ 12ìœ„
   â†“
í‰ê·  ìˆœìœ„: 12.25ìœ„
```

---

### ì‹œë‚˜ë¦¬ì˜¤ 4: ì¿ íŒ¡ íŠ¸ë˜í”½ ìƒì„±

**ëª©ì **: ì¿ íŒ¡ì—ì„œ íŠ¸ë˜í”½ ìƒì„±í•˜ì—¬ ìˆœìœ„ ê°œì„ 

**í• ë‹¹**:
- **íŠ¸ë˜í”½ ìƒì„± ë´‡ 18ê°œ** (Device 1~18)
- **ìˆœìœ„ ì²´í¬ ë´‡ 4ê°œ** (Device 19~22, 30ë¶„ë§ˆë‹¤ ìˆœìœ„ í™•ì¸)

**ì›Œí¬í”Œë¡œìš°**:
```
ì‚¬ìš©ì ì…ë ¥
   â†“
{
  "platform": "coupang",
  "task_type": "traffic",
  "keyword": "ì‚¼ì„± ê°¤ëŸ­ì‹œ S24",
  "product_id": "1234567890",
  "target_count": 100
}
   â†“
Control Tower Agent
   â”œâ”€ L18 ë³€ìˆ˜ ì¡°í•© ìƒì„± (18ê°œ, íŠ¸ë˜í”½ ìƒì„±ìš©)
   â”œâ”€ JSON íŒ¨í„´ ìƒì„± (18ê°œ, ì¿ íŒ¡ CSS Selector ì‚¬ìš©)
   â””â”€ Device 1~18ì—ê²Œ í• ë‹¹
   â†“
íŠ¸ë˜í”½ ìƒì„± ë´‡ ì‹¤í–‰ (15ë¶„ ê°„ê²©, 2ê·¸ë£¹ êµì°¨)
   â”œâ”€ 0ë¶„: ê·¸ë£¹ 1, 3, 5 ì‹¤í–‰
   â”œâ”€ 5ë¶„: í•«ìŠ¤íŒŸ ì¬ì‹œì‘
   â”œâ”€ 15ë¶„: ê·¸ë£¹ 2, 4, 6 ì‹¤í–‰
   â”œâ”€ 20ë¶„: í•«ìŠ¤íŒŸ ì¬ì‹œì‘
   â””â”€ 30ë¶„: ìˆœìœ„ ì²´í¬
   â†“
ìˆœìœ„ ë³€í™” ê°ì§€
   â”œâ”€ 0ë¶„: 12.25ìœ„ (ì´ˆê¸°)
   â”œâ”€ 30ë¶„: 11.00ìœ„ (ê°œì„  +1.25ìœ„) â­
   â”œâ”€ 60ë¶„: 10.50ìœ„ (ê°œì„  +1.75ìœ„) â­â­
   â””â”€ 90ë¶„: 9.75ìœ„ (ê°œì„  +2.50ìœ„) â­â­â­
   â†“
ìœ ì˜ë¯¸í•œ ë³€ìˆ˜ ì €ì¥ (ìˆœìœ„ ê°œì„  > 1ìœ„)
   â”œâ”€ user_agent: Samsung 25.0
   â”œâ”€ cookie_index: 150
   â”œâ”€ scroll_count: 7
   â””â”€ between_wait: 2100ms
```

---

### ì‹œë‚˜ë¦¬ì˜¤ 5: ë„¤ì´ë²„ + ì¿ íŒ¡ ë™ì‹œ ì‹¤í–‰

**ëª©ì **: ë„¤ì´ë²„ì™€ ì¿ íŒ¡ì—ì„œ ë™ì‹œì— íŠ¸ë˜í”½ ìƒì„±

**í• ë‹¹**:
- **ë„¤ì´ë²„ íŠ¸ë˜í”½ ìƒì„± ë´‡ 9ê°œ** (Device 1~9, ê·¸ë£¹ 1~3)
- **ì¿ íŒ¡ íŠ¸ë˜í”½ ìƒì„± ë´‡ 9ê°œ** (Device 10~18, ê·¸ë£¹ 4~6)
- **ë„¤ì´ë²„ ìˆœìœ„ ì²´í¬ ë´‡ 2ê°œ** (Device 19~20)
- **ì¿ íŒ¡ ìˆœìœ„ ì²´í¬ ë´‡ 2ê°œ** (Device 21~22)

**ì›Œí¬í”Œë¡œìš°**:
```
ì‚¬ìš©ì ì…ë ¥ (ë„¤ì´ë²„)
   â†“
{
  "platform": "naver",
  "task_type": "traffic",
  "keyword": "ì‚¼ì„± ê°¤ëŸ­ì‹œ S24",
  "product_id": "12345678",
  "target_count": 50
}
   â†“
ì‚¬ìš©ì ì…ë ¥ (ì¿ íŒ¡)
   â†“
{
  "platform": "coupang",
  "task_type": "traffic",
  "keyword": "ì‚¼ì„± ê°¤ëŸ­ì‹œ S24",
  "product_id": "1234567890",
  "target_count": 50
}
   â†“
Control Tower Agent
   â”œâ”€ ë„¤ì´ë²„ L18 ìƒì„± (9ê°œ) â†’ Device 1~9
   â””â”€ ì¿ íŒ¡ L18 ìƒì„± (9ê°œ) â†’ Device 10~18
   â†“
íŠ¸ë˜í”½ ìƒì„± ë´‡ ì‹¤í–‰ (15ë¶„ ê°„ê²©)
   â”œâ”€ 0ë¶„: ë„¤ì´ë²„ ê·¸ë£¹ 1, 3 + ì¿ íŒ¡ ê·¸ë£¹ 4, 6
   â”œâ”€ 5ë¶„: í•«ìŠ¤íŒŸ ì¬ì‹œì‘
   â”œâ”€ 15ë¶„: ë„¤ì´ë²„ ê·¸ë£¹ 2 + ì¿ íŒ¡ ê·¸ë£¹ 5
   â”œâ”€ 20ë¶„: í•«ìŠ¤íŒŸ ì¬ì‹œì‘
   â””â”€ 30ë¶„: ìˆœìœ„ ì²´í¬ (ë„¤ì´ë²„ Device 19~20, ì¿ íŒ¡ Device 21~22)
   â†“
ê²°ê³¼ ìˆ˜ì§‘
   â”œâ”€ ë„¤ì´ë²„: 7.25ìœ„ â†’ 6.00ìœ„ (ê°œì„  +1.25ìœ„)
   â””â”€ ì¿ íŒ¡: 12.25ìœ„ â†’ 10.50ìœ„ (ê°œì„  +1.75ìœ„)
```

---

## ğŸ“Š ìˆœìœ„ ë³€í™” ê°ì§€ ì‹œìŠ¤í…œ

### 1. ìˆœìœ„ ë³€í™” ê¸°ì¤€ (v2.0)

| ê¸°ì¤€ | ì„¤ëª… | ì¡°ì¹˜ |
|------|------|------|
| **ìœ ì˜ë¯¸í•œ ê°œì„ ** | 100íšŒ íŠ¸ë˜í”½ ì‘ì—… í›„ 50ìœ„ ì´ìƒ ìˆœìœ„ ìƒìŠ¹ | âœ… ë³€ìˆ˜ ì €ì¥ + ë³„ë„ í…ŒìŠ¤íŠ¸ |
| **ë¯¸ë¯¸í•œ ê°œì„ ** | 100íšŒ íŠ¸ë˜í”½ ì‘ì—… í›„ 10~49ìœ„ ìˆœìœ„ ìƒìŠ¹ | âš ï¸ ê´€ì°° |
| **ë³€í™” ì—†ìŒ** | 100íšŒ íŠ¸ë˜í”½ ì‘ì—… í›„ -10~9ìœ„ ìˆœìœ„ ë³€ë™ | âŒ ë¬´ì‹œ |
| **ìˆœìœ„ í•˜ë½** | 100íšŒ íŠ¸ë˜í”½ ì‘ì—… í›„ 10ìœ„ ì´ìƒ ìˆœìœ„ í•˜ë½ | ğŸ”´ ì‹¤íŒ¨ ë¶„ì„ |

---

### 2. ìˆœìœ„ ë³€í™” ê°ì§€ ë¡œì§

```python
class RankingChangeDetectorV2:
    def __init__(self):
        self.threshold_significant = 50.0  # ìœ ì˜ë¯¸í•œ ê°œì„ : 50ìœ„ ì´ìƒ ìƒìŠ¹
        self.threshold_minor = 10.0  # ë¯¸ë¯¸í•œ ê°œì„ : 10ìœ„ ì´ìƒ ìƒìŠ¹
        self.required_traffic_count = 100  # í•„ìˆ˜ íŠ¸ë˜í”½ ì‘ì—… íšŸìˆ˜
    
    def detect_change(self, initial_rank: float, current_rank: float, traffic_count: int) -> dict:
        """
        ìˆœìœ„ ë³€í™” ê°ì§€
        
        Args:
            initial_rank: ì´ˆê¸° ìˆœìœ„ (ì˜ˆ: 7.25)
            current_rank: í˜„ì¬ ìˆœìœ„ (ì˜ˆ: 6.00)
        
        Returns:
            {
                "change": 1.25,  # ìˆœìœ„ ê°œì„  (ì–‘ìˆ˜ = ê°œì„ , ìŒìˆ˜ = í•˜ë½)
                "type": "significant",  # "significant", "minor", "none", "decline"
                "action": "save_and_test"  # "save_and_test", "observe", "ignore", "analyze_failure"
            }
        """
        if traffic_count < self.required_traffic_count:
            return {
                "change": 0,
                "type": "pending",
                "action": "wait",
                "traffic_count": traffic_count
            }
        
        change = initial_rank - current_rank
        
        if change >= self.threshold_significant:
            return {
                "change": change,
                "type": "significant",
                "action": "save_and_test"
            }
        elif change >= self.threshold_minor:
            return {
                "change": change,
                "type": "minor",
                "action": "observe"
            }
        elif change >= -self.threshold_minor:
            return {
                "change": change,
                "type": "none",
                "action": "ignore"
            }
        else:
            return {
                "change": change,
                "type": "decline",
                "action": "analyze_failure"
            }
```

---

### 3. ë³€ìˆ˜ ì €ì¥ ì‹œìŠ¤í…œ

```python
class SignificantVariableStore:
    def __init__(self, db: Database):
        self.db = db
    
    async def save_significant_variables(
        self,
        campaign_id: str,
        platform: str,
        keyword: str,
        product_id: str,
        variables: dict,
        ranking_change: float,
        initial_rank: float,
        final_rank: float
    ):
        """
        ìœ ì˜ë¯¸í•œ ë³€ìˆ˜ ì €ì¥
        
        Args:
            campaign_id: ìº í˜ì¸ ID
            platform: í”Œë«í¼ (naver, coupang)
            keyword: í‚¤ì›Œë“œ
            product_id: ì œí’ˆ ID
            variables: ë³€ìˆ˜ ì¡°í•© (ì˜ˆ: {"user_agent": "Samsung 24.0", ...})
            ranking_change: ìˆœìœ„ ê°œì„  (ì˜ˆ: 1.25)
            initial_rank: ì´ˆê¸° ìˆœìœ„ (ì˜ˆ: 7.25)
            final_rank: ìµœì¢… ìˆœìœ„ (ì˜ˆ: 6.00)
        """
        await self.db.execute(
            """
            INSERT INTO significant_variables (
                campaign_id,
                platform,
                keyword,
                product_id,
                variables,
                ranking_change,
                initial_rank,
                final_rank,
                created_at
            ) VALUES ($1, $2, $3, $4, $5, $6, $7, $8, NOW())
            """,
            campaign_id,
            platform,
            keyword,
            product_id,
            json.dumps(variables),
            ranking_change,
            initial_rank,
            final_rank
        )
```

---

### 4. ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

```sql
CREATE TABLE significant_variables (
    id SERIAL PRIMARY KEY,
    campaign_id VARCHAR(36) NOT NULL,
    platform VARCHAR(20) NOT NULL,  -- "naver" or "coupang"
    keyword VARCHAR(255) NOT NULL,
    product_id VARCHAR(50) NOT NULL,
    variables JSONB NOT NULL,  -- ë³€ìˆ˜ ì¡°í•©
    ranking_change FLOAT NOT NULL,  -- ìˆœìœ„ ê°œì„  (ì˜ˆ: 1.25)
    initial_rank FLOAT NOT NULL,  -- ì´ˆê¸° ìˆœìœ„ (ì˜ˆ: 7.25)
    final_rank FLOAT NOT NULL,  -- ìµœì¢… ìˆœìœ„ (ì˜ˆ: 6.00)
    test_status VARCHAR(20) DEFAULT 'pending',  -- "pending", "testing", "confirmed", "rejected"
    test_campaign_id VARCHAR(36),  -- ë³„ë„ í…ŒìŠ¤íŠ¸ ìº í˜ì¸ ID
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    tested_at TIMESTAMP,
    FOREIGN KEY (campaign_id) REFERENCES campaigns(campaign_id)
);

CREATE INDEX idx_significant_variables_platform ON significant_variables(platform);
CREATE INDEX idx_significant_variables_keyword ON significant_variables(keyword);
CREATE INDEX idx_significant_variables_test_status ON significant_variables(test_status);
```

---

## ğŸ§ª ìœ ì˜ë¯¸í•œ ë³€ìˆ˜ ë³„ë„ í…ŒìŠ¤íŠ¸ ì‹œìŠ¤í…œ

### 1. ë³„ë„ í…ŒìŠ¤íŠ¸ ì›Œí¬í”Œë¡œìš°

```
ìœ ì˜ë¯¸í•œ ë³€ìˆ˜ ì €ì¥
   â†“
ë³„ë„ í…ŒìŠ¤íŠ¸ ìº í˜ì¸ ìƒì„±
   â”œâ”€ í”Œë«í¼: ë™ì¼ (ë„¤ì´ë²„ or ì¿ íŒ¡)
   â”œâ”€ í‚¤ì›Œë“œ: ë™ì¼
   â”œâ”€ ì œí’ˆ ID: ë™ì¼
   â”œâ”€ ë³€ìˆ˜: ì €ì¥ëœ ë³€ìˆ˜ë§Œ ì‚¬ìš©
   â””â”€ ë´‡ ìˆ˜: 6ê°œ (ê·¸ë£¹ 1~2ë§Œ ì‚¬ìš©)
   â†“
í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (30ë¶„)
   â”œâ”€ 0ë¶„: ì´ˆê¸° ìˆœìœ„ ì²´í¬
   â”œâ”€ 0ë¶„: ê·¸ë£¹ 1 ì‹¤í–‰ (3ê°œ ë´‡)
   â”œâ”€ 15ë¶„: ê·¸ë£¹ 2 ì‹¤í–‰ (3ê°œ ë´‡)
   â””â”€ 30ë¶„: ìµœì¢… ìˆœìœ„ ì²´í¬
   â†“
ê²°ê³¼ ë¶„ì„
   â”œâ”€ ìˆœìœ„ ê°œì„  â‰¥ 50ìœ„ â†’ âœ… í™•ì¸ (confirmed)
   â””â”€ ìˆœìœ„ ê°œì„  < 50ìœ„ â†’ âŒ ê±°ë¶€ (rejected)
   â†“
ë³€ìˆ˜ ìƒíƒœ ì—…ë°ì´íŠ¸
   â”œâ”€ confirmed â†’ í–¥í›„ ìº í˜ì¸ì—ì„œ ìš°ì„  ì‚¬ìš©
   â””â”€ rejected â†’ ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•ŠìŒ
```

---

### 2. ë³„ë„ í…ŒìŠ¤íŠ¸ ìë™ ì‹¤í–‰

```python
class SignificantVariableTester:
    def __init__(self, control_tower: ControlTowerAgent):
        self.control_tower = control_tower
    
    async def auto_test_significant_variables(self):
        """
        ìœ ì˜ë¯¸í•œ ë³€ìˆ˜ ìë™ í…ŒìŠ¤íŠ¸
        
        - 1ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰
        - test_status = "pending"ì¸ ë³€ìˆ˜ë§Œ í…ŒìŠ¤íŠ¸
        - ìµœëŒ€ 3ê°œì”© í…ŒìŠ¤íŠ¸
        """
        while True:
            # 1. pending ìƒíƒœ ë³€ìˆ˜ ì¡°íšŒ
            pending_vars = await self.db.fetch(
                """
                SELECT * FROM significant_variables
                WHERE test_status = 'pending'
                ORDER BY ranking_change DESC
                LIMIT 3
                """
            )
            
            # 2. ê° ë³€ìˆ˜ì— ëŒ€í•´ ë³„ë„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
            for var in pending_vars:
                # 2-1. í…ŒìŠ¤íŠ¸ ìº í˜ì¸ ìƒì„±
                test_campaign_id = await self.control_tower.create_campaign(
                    platform=var["platform"],
                    keyword=var["keyword"],
                    product_id=var["product_id"],
                    task_type="traffic",
                    target_count=6,  # 6ê°œ ë´‡ë§Œ ì‚¬ìš©
                    variables=var["variables"],  # ì €ì¥ëœ ë³€ìˆ˜ ì‚¬ìš©
                    is_test=True  # í…ŒìŠ¤íŠ¸ í”Œë˜ê·¸
                )
                
                # 2-2. í…ŒìŠ¤íŠ¸ ìƒíƒœ ì—…ë°ì´íŠ¸
                await self.db.execute(
                    """
                    UPDATE significant_variables
                    SET test_status = 'testing',
                        test_campaign_id = $1,
                        tested_at = NOW()
                    WHERE id = $2
                    """,
                    test_campaign_id,
                    var["id"]
                )
                
                # 2-3. í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (30ë¶„)
                await self.control_tower.run_campaign(test_campaign_id)
                
                # 2-4. ê²°ê³¼ ë¶„ì„
                result = await self.control_tower.get_campaign_result(test_campaign_id)
                
                if result["ranking_change"] >= 50.0:
                    # í™•ì¸ (confirmed)
                    await self.db.execute(
                        """
                        UPDATE significant_variables
                        SET test_status = 'confirmed'
                        WHERE id = $1
                        """,
                        var["id"]
                    )
                else:
                    # ê±°ë¶€ (rejected)
                    await self.db.execute(
                        """
                        UPDATE significant_variables
                        SET test_status = 'rejected'
                        WHERE id = $1
                        """,
                        var["id"]
                    )
            
            # 3. 1ì‹œê°„ ëŒ€ê¸°
            await asyncio.sleep(3600)
```

---

## ğŸ“ˆ ì‘ì—… í• ë‹¹ ìš°ì„ ìˆœìœ„

### 1. ë´‡ í• ë‹¹ ìš°ì„ ìˆœìœ„

| ìš°ì„ ìˆœìœ„ | ì‘ì—… | ë´‡ ìˆ˜ | ë””ë°”ì´ìŠ¤ |
|---------|------|------|---------|
| **1** | ë„¤ì´ë²„ íŠ¸ë˜í”½ ìƒì„± | 18ê°œ | Device 1~18 |
| **2** | ë„¤ì´ë²„ ìˆœìœ„ ì²´í¬ | 4ê°œ | Device 19~22 |
| **3** | ì¿ íŒ¡ íŠ¸ë˜í”½ ìƒì„± | 18ê°œ | Device 1~18 |
| **4** | ì¿ íŒ¡ ìˆœìœ„ ì²´í¬ | 4ê°œ | Device 19~22 |
| **5** | ë„¤ì´ë²„ + ì¿ íŒ¡ ë™ì‹œ | 9ê°œ + 9ê°œ | Device 1~9, 10~18 |

---

### 2. ë³€ìˆ˜ ì‚¬ìš© ìš°ì„ ìˆœìœ„

| ìš°ì„ ìˆœìœ„ | ë³€ìˆ˜ ì¶œì²˜ | ì„¤ëª… |
|---------|----------|------|
| **1** | confirmed ë³€ìˆ˜ | ë³„ë„ í…ŒìŠ¤íŠ¸ í™•ì¸ëœ ë³€ìˆ˜ (ìˆœìœ„ ê°œì„  â‰¥ 1ìœ„) |
| **2** | significant ë³€ìˆ˜ | ìœ ì˜ë¯¸í•œ ë³€ìˆ˜ (ìˆœìœ„ ê°œì„  â‰¥ 1ìœ„, í…ŒìŠ¤íŠ¸ ì „) |
| **3** | L18 ë³€ìˆ˜ | ìƒˆë¡œ ìƒì„±ëœ L18 ë³€ìˆ˜ ì¡°í•© |

---

### 3. ì‘ì—… ìŠ¤ì¼€ì¤„ë§ ìš°ì„ ìˆœìœ„

| ìš°ì„ ìˆœìœ„ | ì‘ì—… | ì„¤ëª… |
|---------|------|------|
| **1** | ìˆœìœ„ ì²´í¬ | 30ë¶„ë§ˆë‹¤ ì‹¤í–‰ (í•­ìƒ ìµœìš°ì„ ) |
| **2** | ìœ ì˜ë¯¸í•œ ë³€ìˆ˜ í…ŒìŠ¤íŠ¸ | 1ì‹œê°„ë§ˆë‹¤ ì‹¤í–‰ (ìë™) |
| **3** | íŠ¸ë˜í”½ ìƒì„± | 15ë¶„ ê°„ê²© ì‹¤í–‰ (ì‚¬ìš©ì ìš”ì²­) |

---

## ğŸ¯ ìµœì¢… ì •ë¦¬

### ì‘ì—… í• ë‹¹ ì „ëµ

1. âœ… **ìˆœìœ„ ì²´í¬ ì „ìš© ë´‡**: Device 19~22 (4ê°œ)
2. âœ… **íŠ¸ë˜í”½ ìƒì„± ë´‡**: Device 1~18 (18ê°œ)
3. âœ… **í”Œë«í¼ë³„ í• ë‹¹**: ë„¤ì´ë²„ or ì¿ íŒ¡ or ë™ì‹œ
4. âœ… **2ê·¸ë£¹ êµì°¨ ì‹¤í–‰**: 15ë¶„ ê°„ê²©

---

### ìˆœìœ„ ë³€í™” ê°ì§€

1. âœ… **ìœ ì˜ë¯¸í•œ ê°œì„ **: ìˆœìœ„ ê°œì„  â‰¥ 1ìœ„
2. âœ… **ë³€ìˆ˜ ìë™ ì €ì¥**: significant_variables í…Œì´ë¸”
3. âœ… **ë³„ë„ í…ŒìŠ¤íŠ¸ ìë™ ì‹¤í–‰**: 1ì‹œê°„ë§ˆë‹¤
4. âœ… **í™•ì¸ëœ ë³€ìˆ˜ ìš°ì„  ì‚¬ìš©**: confirmed ë³€ìˆ˜

---

### í•µì‹¬ ì°¨ë³„ì 

| í•­ëª© | ê¸°ì¡´ ì‹œìŠ¤í…œ | Turafic |
|------|-----------|---------|
| **ì‘ì—… í• ë‹¹** | ìˆ˜ë™ | **ìë™** â­ |
| **ìˆœìœ„ ë³€í™” ê°ì§€** | ìˆ˜ë™ | **ìë™** â­ |
| **ë³€ìˆ˜ ì €ì¥** | ìˆ˜ë™ | **ìë™** â­ |
| **ë³„ë„ í…ŒìŠ¤íŠ¸** | ìˆ˜ë™ | **ìë™ (1ì‹œê°„ë§ˆë‹¤)** â­ |
| **ë³€ìˆ˜ ìš°ì„ ìˆœìœ„** | ì—†ìŒ | **confirmed > significant > L18** â­ |

---

**ì‘ì„±ì**: Manus AI Agent  
**ìµœì¢… ìˆ˜ì •ì¼**: 2025-11-05  
**ë²„ì „**: 1.0

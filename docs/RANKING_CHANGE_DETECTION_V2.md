# ìˆœìœ„ ë³€í™” ê°ì§€ ì‹œìŠ¤í…œ v2.0

**ì‘ì„±ì¼**: 2025-11-05  
**ë²„ì „**: 2.0  
**ì‘ì„±ì**: Manus AI Agent  
**ëª©ì **: ìœ ì˜ë¯¸í•œ ìˆœìœ„ ê°œì„  ê¸°ì¤€ì„ **100íšŒ íŠ¸ë˜í”½ ì‘ì—… í›„ 50ìœ„ ì´ìƒ ìˆœìœ„ ìƒìŠ¹**ìœ¼ë¡œ ì¬ì •ì˜í•˜ê³ , ìˆœìœ„ ë³€ë™ ì´ë ¥ ê´€ë¦¬ì ë·°ë¥¼ ì„¤ê³„í•©ë‹ˆë‹¤.

---

## 1. ğŸ¯ ìœ ì˜ë¯¸í•œ ìˆœìœ„ ê°œì„  ê¸°ì¤€ (v2.0)

### 1.1. ê¸°ì¤€ ë³€ê²½ ì‚¬í•­

| í•­ëª© | v1.0 (ê¸°ì¡´) | **v2.0 (ì‹ ê·œ)** |
|---|---|---|
| **ìœ ì˜ë¯¸í•œ ê°œì„ ** | ìˆœìœ„ ê°œì„  â‰¥ 1ìœ„ | **100íšŒ íŠ¸ë˜í”½ ì‘ì—… í›„ 50ìœ„ ì´ìƒ ìˆœìœ„ ìƒìŠ¹** |
| **ë¯¸ë¯¸í•œ ê°œì„ ** | 0.5ìœ„ â‰¤ ìˆœìœ„ ê°œì„  < 1ìœ„ | **100íšŒ íŠ¸ë˜í”½ ì‘ì—… í›„ 10~49ìœ„ ìˆœìœ„ ìƒìŠ¹** |
| **ë³€í™” ì—†ìŒ** | -0.5ìœ„ < ìˆœìœ„ ê°œì„  < 0.5ìœ„ | **100íšŒ íŠ¸ë˜í”½ ì‘ì—… í›„ -10~9ìœ„ ìˆœìœ„ ë³€ë™** |
| **ìˆœìœ„ í•˜ë½** | ìˆœìœ„ ê°œì„  < -0.5ìœ„ | **100íšŒ íŠ¸ë˜í”½ ì‘ì—… í›„ 10ìœ„ ì´ìƒ ìˆœìœ„ í•˜ë½** |

### 1.2. ë³€ê²½ ì´ìœ 

ê¸°ì¡´ v1.0ì—ì„œëŠ” ìˆœìœ„ê°€ 1ìœ„ë§Œ ìƒìŠ¹í•´ë„ 'ìœ ì˜ë¯¸í•œ ê°œì„ 'ìœ¼ë¡œ íŒì •í–ˆìœ¼ë‚˜, ì´ëŠ” ë‹¤ìŒê³¼ ê°™ì€ ë¬¸ì œê°€ ìˆì—ˆìŠµë‹ˆë‹¤.

- **ë…¸ì´ì¦ˆ ë¯¼ê°ì„±**: í”Œë«í¼ì˜ ìˆœìœ„ ì•Œê³ ë¦¬ì¦˜ì€ ì‹œê°„ëŒ€, ì‚¬ìš©ì ìœ„ì¹˜, ê´‘ê³  ë…¸ì¶œ ë“± ë‹¤ì–‘í•œ ì™¸ë¶€ ìš”ì¸ì— ì˜í•´ 1~2ìœ„ ì •ë„ëŠ” ìì—°ìŠ¤ëŸ½ê²Œ ë³€ë™í•©ë‹ˆë‹¤. ì´ëŸ¬í•œ ë…¸ì´ì¦ˆë¥¼ 'ìœ ì˜ë¯¸í•œ ê°œì„ 'ìœ¼ë¡œ ì˜¤íŒí•  ê°€ëŠ¥ì„±ì´ ë†’ìŠµë‹ˆë‹¤.
- **ì‹¤ìš©ì„± ë¶€ì¡±**: ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ ê´€ì ì—ì„œ 157ìœ„ì—ì„œ 156ìœ„ë¡œ 1ìœ„ ìƒìŠ¹í•˜ëŠ” ê²ƒì€ íŠ¸ë˜í”½ì´ë‚˜ ë§¤ì¶œì— ê±°ì˜ ì˜í–¥ì„ ì£¼ì§€ ì•ŠìŠµë‹ˆë‹¤. ë°˜ë©´, 157ìœ„ì—ì„œ 95ìœ„ë¡œ 62ìœ„ ìƒìŠ¹í•˜ëŠ” ê²ƒì€ ê²€ìƒ‰ ê²°ê³¼ ìƒìœ„ í˜ì´ì§€ë¡œ ì§„ì…í•˜ì—¬ ì‹¤ì§ˆì ì¸ íš¨ê³¼ë¥¼ ê¸°ëŒ€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
- **íŠ¸ë˜í”½ ì‘ì—…ëŸ‰ ê³ ë ¤ ë¶€ì¡±**: ë‹¨ ëª‡ íšŒì˜ íŠ¸ë˜í”½ ì‘ì—… í›„ ìš°ì—°íˆ 1ìœ„ ìƒìŠ¹í•œ ê²½ìš°ì™€, 100íšŒì˜ ì²´ê³„ì ì¸ íŠ¸ë˜í”½ ì‘ì—… í›„ 50ìœ„ ìƒìŠ¹í•œ ê²½ìš°ë¥¼ ë™ì¼í•˜ê²Œ ì·¨ê¸‰í•˜ëŠ” ê²ƒì€ ë¹„í•©ë¦¬ì ì…ë‹ˆë‹¤.

ë”°ë¼ì„œ v2.0ì—ì„œëŠ” **"100íšŒ íŠ¸ë˜í”½ ì‘ì—…"**ì´ë¼ëŠ” ëª…í™•í•œ ì‘ì—…ëŸ‰ ê¸°ì¤€ê³¼ **"50ìœ„ ì´ìƒ ìƒìŠ¹"**ì´ë¼ëŠ” ì‹¤ì§ˆì ì¸ íš¨ê³¼ ê¸°ì¤€ì„ í•¨ê»˜ ì ìš©í•˜ì—¬, ë…¸ì´ì¦ˆë¥¼ ë°°ì œí•˜ê³  ì§„ì •ìœ¼ë¡œ ìœ ì˜ë¯¸í•œ ìˆœìœ„ ê°œì„ ë§Œì„ ê°ì§€í•©ë‹ˆë‹¤.

---

## 2. ğŸ“Š ìˆœìœ„ ë³€í™” ê°ì§€ ë¡œì§ (v2.0)

### 2.1. Python êµ¬í˜„

```python
class RankingChangeDetectorV2:
    """
    ìˆœìœ„ ë³€í™” ê°ì§€ ì‹œìŠ¤í…œ v2.0
    
    - 100íšŒ íŠ¸ë˜í”½ ì‘ì—… ì™„ë£Œ í›„ì—ë§Œ íŒì •
    - 50ìœ„ ì´ìƒ ìƒìŠ¹ ì‹œ 'ìœ ì˜ë¯¸í•œ ê°œì„ 'ìœ¼ë¡œ íŒì •
    """
    
    def __init__(self):
        self.threshold_significant = 50.0  # ìœ ì˜ë¯¸í•œ ê°œì„ : 50ìœ„ ì´ìƒ ìƒìŠ¹
        self.threshold_minor = 10.0  # ë¯¸ë¯¸í•œ ê°œì„ : 10ìœ„ ì´ìƒ ìƒìŠ¹
        self.required_traffic_count = 100  # í•„ìˆ˜ íŠ¸ë˜í”½ ì‘ì—… íšŸìˆ˜
    
    def detect_change(
        self,
        initial_rank: float,
        current_rank: float,
        traffic_count: int
    ) -> dict:
        """
        ìˆœìœ„ ë³€í™” ê°ì§€
        
        Args:
            initial_rank: ì´ˆê¸° ìˆœìœ„ (ì˜ˆ: 157.0)
            current_rank: í˜„ì¬ ìˆœìœ„ (ì˜ˆ: 95.0)
            traffic_count: í˜„ì¬ê¹Œì§€ ì™„ë£Œëœ íŠ¸ë˜í”½ ì‘ì—… íšŸìˆ˜ (ì˜ˆ: 100)
        
        Returns:
            {
                "change": 62.0,  # ìˆœìœ„ ê°œì„  (ì–‘ìˆ˜ = ê°œì„ , ìŒìˆ˜ = í•˜ë½)
                "type": "significant",  # "pending", "significant", "minor", "none", "decline"
                "action": "save_and_test",  # "wait", "save_and_test", "observe", "ignore", "analyze_failure"
                "traffic_count": 100,
                "progress": 1.0  # ì§„í–‰ë¥  (0.0 ~ 1.0)
            }
        """
        # 1. 100íšŒ íŠ¸ë˜í”½ ì‘ì—…ì´ ì™„ë£Œë˜ì§€ ì•Šì•˜ìœ¼ë©´ íŒì • ë³´ë¥˜
        if traffic_count < self.required_traffic_count:
            return {
                "change": 0,
                "type": "pending",
                "action": "wait",
                "traffic_count": traffic_count,
                "progress": traffic_count / self.required_traffic_count
            }
        
        # 2. ìˆœìœ„ ë³€í™” ê³„ì‚° (ì´ˆê¸° ìˆœìœ„ - í˜„ì¬ ìˆœìœ„)
        # ì˜ˆ: 157 - 95 = 62 (62ìœ„ ìƒìŠ¹)
        change = initial_rank - current_rank
        
        # 3. ìˆœìœ„ ë³€í™” íŒì •
        if change >= self.threshold_significant:
            # 50ìœ„ ì´ìƒ ìƒìŠ¹ â†’ ìœ ì˜ë¯¸í•œ ê°œì„ 
            return {
                "change": change,
                "type": "significant",
                "action": "save_and_test",
                "traffic_count": traffic_count,
                "progress": 1.0
            }
        elif change >= self.threshold_minor:
            # 10~49ìœ„ ìƒìŠ¹ â†’ ë¯¸ë¯¸í•œ ê°œì„ 
            return {
                "change": change,
                "type": "minor",
                "action": "observe",
                "traffic_count": traffic_count,
                "progress": 1.0
            }
        elif change >= -self.threshold_minor:
            # -10~9ìœ„ ë³€ë™ â†’ ë³€í™” ì—†ìŒ
            return {
                "change": change,
                "type": "none",
                "action": "ignore",
                "traffic_count": traffic_count,
                "progress": 1.0
            }
        else:
            # 10ìœ„ ì´ìƒ í•˜ë½ â†’ ìˆœìœ„ í•˜ë½ (ì‹¤íŒ¨ ë¶„ì„ í•„ìš”)
            return {
                "change": change,
                "type": "decline",
                "action": "analyze_failure",
                "traffic_count": traffic_count,
                "progress": 1.0
            }
```

### 2.2. ì‚¬ìš© ì˜ˆì‹œ

```python
# ì˜ˆì‹œ 1: 100íšŒ íŠ¸ë˜í”½ ì‘ì—… ì „ (ì§„í–‰ ì¤‘)
detector = RankingChangeDetectorV2()
result = detector.detect_change(
    initial_rank=157.0,
    current_rank=140.0,
    traffic_count=45  # ì•„ì§ 45íšŒë§Œ ì™„ë£Œ
)
print(result)
# {
#     "change": 0,
#     "type": "pending",
#     "action": "wait",
#     "traffic_count": 45,
#     "progress": 0.45
# }

# ì˜ˆì‹œ 2: 100íšŒ íŠ¸ë˜í”½ ì‘ì—… ì™„ë£Œ í›„ (ìœ ì˜ë¯¸í•œ ê°œì„ )
result = detector.detect_change(
    initial_rank=157.0,
    current_rank=95.0,
    traffic_count=100
)
print(result)
# {
#     "change": 62.0,
#     "type": "significant",
#     "action": "save_and_test",
#     "traffic_count": 100,
#     "progress": 1.0
# }

# ì˜ˆì‹œ 3: 100íšŒ íŠ¸ë˜í”½ ì‘ì—… ì™„ë£Œ í›„ (ë¯¸ë¯¸í•œ ê°œì„ )
result = detector.detect_change(
    initial_rank=157.0,
    current_rank=135.0,
    traffic_count=100
)
print(result)
# {
#     "change": 22.0,
#     "type": "minor",
#     "action": "observe",
#     "traffic_count": 100,
#     "progress": 1.0
# }

# ì˜ˆì‹œ 4: 100íšŒ íŠ¸ë˜í”½ ì‘ì—… ì™„ë£Œ í›„ (ìˆœìœ„ í•˜ë½)
result = detector.detect_change(
    initial_rank=157.0,
    current_rank=175.0,
    traffic_count=100
)
print(result)
# {
#     "change": -18.0,
#     "type": "decline",
#     "action": "analyze_failure",
#     "traffic_count": 100,
#     "progress": 1.0
# }
```

---

## 3. ğŸ—„ï¸ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ì—…ë°ì´íŠ¸

### 3.1. `campaigns` í…Œì´ë¸”ì— `traffic_count` ì»¬ëŸ¼ ì¶”ê°€

```sql
ALTER TABLE campaigns
ADD COLUMN traffic_count INT DEFAULT 0,
ADD COLUMN traffic_target INT DEFAULT 100;

COMMENT ON COLUMN campaigns.traffic_count IS 'í˜„ì¬ê¹Œì§€ ì™„ë£Œëœ íŠ¸ë˜í”½ ì‘ì—… íšŸìˆ˜';
COMMENT ON COLUMN campaigns.traffic_target IS 'ëª©í‘œ íŠ¸ë˜í”½ ì‘ì—… íšŸìˆ˜ (ê¸°ë³¸ê°’: 100)';
```

### 3.2. `significant_variables` í…Œì´ë¸”ì— `traffic_count` ì»¬ëŸ¼ ì¶”ê°€

```sql
ALTER TABLE significant_variables
ADD COLUMN traffic_count INT NOT NULL DEFAULT 100;

COMMENT ON COLUMN significant_variables.traffic_count IS 'í•´ë‹¹ ë³€ìˆ˜ë¡œ ìˆ˜í–‰í•œ íŠ¸ë˜í”½ ì‘ì—… íšŸìˆ˜';
```

### 3.3. `ranking_history` í…Œì´ë¸” (ì‹ ê·œ)

```sql
CREATE TABLE ranking_history (
    id SERIAL PRIMARY KEY,
    campaign_id VARCHAR(36) NOT NULL,
    bot_id VARCHAR(50) NOT NULL,
    keyword VARCHAR(255) NOT NULL,
    product_id VARCHAR(50) NOT NULL,
    rank_position INT NOT NULL,
    traffic_count INT NOT NULL,  -- í•´ë‹¹ ìˆœìœ„ ì¸¡ì • ì‹œì ì˜ íŠ¸ë˜í”½ ì‘ì—… íšŸìˆ˜
    reliability_score FLOAT DEFAULT 0.0,
    measured_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    FOREIGN KEY (campaign_id) REFERENCES campaigns(campaign_id)
);

CREATE INDEX idx_ranking_history_campaign ON ranking_history(campaign_id);
CREATE INDEX idx_ranking_history_traffic_count ON ranking_history(traffic_count);
CREATE INDEX idx_ranking_history_measured_at ON ranking_history(measured_at);

COMMENT ON TABLE ranking_history IS 'ëª¨ë“  ë´‡ì˜ ì›ì‹œ ìˆœìœ„ ì¸¡ì • ê¸°ë¡ (íŠ¸ë˜í”½ ì‘ì—… íšŸìˆ˜ í¬í•¨)';
```

---

## 4. ğŸ“ˆ ìˆœìœ„ ë³€ë™ ì´ë ¥ ê´€ë¦¬ì ë·°

### 4.1. ê´€ë¦¬ì ë·° ìš”êµ¬ì‚¬í•­

ê´€ë¦¬ìëŠ” ë‹¤ìŒ ì •ë³´ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸í•  ìˆ˜ ìˆì–´ì•¼ í•©ë‹ˆë‹¤.

1. **ìº í˜ì¸ë³„ ìˆœìœ„ ë³€ë™ ê·¸ë˜í”„**: íŠ¸ë˜í”½ ì‘ì—… íšŸìˆ˜(Xì¶•) vs ìˆœìœ„(Yì¶•)
2. **ìœ ì˜ë¯¸í•œ ìˆœìœ„ ê°œì„  ì´ë²¤íŠ¸**: 100íšŒ ì™„ë£Œ ì‹œì ì— 50ìœ„ ì´ìƒ ìƒìŠ¹í•œ ìº í˜ì¸ ëª©ë¡
3. **ì§„í–‰ ì¤‘ì¸ ìº í˜ì¸ í˜„í™©**: í˜„ì¬ íŠ¸ë˜í”½ ì‘ì—… ì§„í–‰ë¥ (ì˜ˆ: 45/100)ê³¼ ì„ì‹œ ìˆœìœ„ ë³€í™”
4. **ë³€ìˆ˜ ì¡°í•©ë³„ íš¨ê³¼ ë¹„êµ**: ì–´ë–¤ ë³€ìˆ˜ ì¡°í•©ì´ ê°€ì¥ ë†’ì€ ìˆœìœ„ ìƒìŠ¹ì„ ë‹¬ì„±í–ˆëŠ”ì§€ ë¹„êµ
5. **í”Œë«í¼ë³„ í†µê³„**: ë„¤ì´ë²„ vs ì¿ íŒ¡ì—ì„œ í‰ê·  ìˆœìœ„ ìƒìŠ¹í­ ë¹„êµ

### 4.2. REST API ì—”ë“œí¬ì¸íŠ¸

```python
# FastAPI ì—”ë“œí¬ì¸íŠ¸ ì •ì˜
from fastapi import APIRouter, Query
from typing import List, Optional

router = APIRouter(prefix="/api/v1/admin/ranking", tags=["Admin - Ranking History"])

@router.get("/history/{campaign_id}")
async def get_ranking_history(
    campaign_id: str,
    limit: int = Query(100, description="ì¡°íšŒí•  ìµœëŒ€ ê¸°ë¡ ìˆ˜")
):
    """
    íŠ¹ì • ìº í˜ì¸ì˜ ìˆœìœ„ ë³€ë™ ì´ë ¥ ì¡°íšŒ
    
    Returns:
        [
            {
                "traffic_count": 0,
                "rank_position": 157.0,
                "measured_at": "2025-11-05T10:00:00"
            },
            {
                "traffic_count": 25,
                "rank_position": 145.0,
                "measured_at": "2025-11-05T10:30:00"
            },
            {
                "traffic_count": 50,
                "rank_position": 128.0,
                "measured_at": "2025-11-05T11:00:00"
            },
            {
                "traffic_count": 75,
                "rank_position": 110.0,
                "measured_at": "2025-11-05T11:30:00"
            },
            {
                "traffic_count": 100,
                "rank_position": 95.0,
                "measured_at": "2025-11-05T12:00:00",
                "change_detected": {
                    "change": 62.0,
                    "type": "significant",
                    "action": "save_and_test"
                }
            }
        ]
    """
    pass

@router.get("/significant-changes")
async def get_significant_changes(
    platform: Optional[str] = Query(None, description="í”Œë«í¼ í•„í„° (naver, coupang)"),
    start_date: Optional[str] = Query(None, description="ì‹œì‘ ë‚ ì§œ (YYYY-MM-DD)"),
    end_date: Optional[str] = Query(None, description="ì¢…ë£Œ ë‚ ì§œ (YYYY-MM-DD)"),
    limit: int = Query(50, description="ì¡°íšŒí•  ìµœëŒ€ ê¸°ë¡ ìˆ˜")
):
    """
    ìœ ì˜ë¯¸í•œ ìˆœìœ„ ê°œì„  ì´ë²¤íŠ¸ ëª©ë¡ ì¡°íšŒ
    
    Returns:
        [
            {
                "campaign_id": "c1a2b3c4",
                "platform": "naver",
                "keyword": "ì‚¼ì„± ê°¤ëŸ­ì‹œ S24",
                "product_id": "12345678",
                "initial_rank": 157.0,
                "final_rank": 95.0,
                "change": 62.0,
                "traffic_count": 100,
                "variables": {
                    "user_agent": "Samsung 24.0",
                    "cookie_index": 100,
                    "scroll_count": 6,
                    "between_wait": 1900
                },
                "detected_at": "2025-11-05T12:00:00"
            },
            ...
        ]
    """
    pass

@router.get("/progress")
async def get_campaigns_progress(
    status: str = Query("active", description="ìº í˜ì¸ ìƒíƒœ (active, completed)")
):
    """
    ì§„í–‰ ì¤‘ì¸ ìº í˜ì¸ í˜„í™© ì¡°íšŒ
    
    Returns:
        [
            {
                "campaign_id": "c5d6e7f8",
                "platform": "coupang",
                "keyword": "ë¬´ì„  ì´ì–´í°",
                "product_id": "9876543210",
                "initial_rank": 230.0,
                "current_rank": 195.0,
                "traffic_count": 45,
                "traffic_target": 100,
                "progress": 0.45,
                "estimated_completion": "2025-11-05T14:30:00"
            },
            ...
        ]
    """
    pass

@router.get("/statistics")
async def get_ranking_statistics(
    platform: Optional[str] = Query(None, description="í”Œë«í¼ í•„í„° (naver, coupang)"),
    start_date: Optional[str] = Query(None, description="ì‹œì‘ ë‚ ì§œ (YYYY-MM-DD)"),
    end_date: Optional[str] = Query(None, description="ì¢…ë£Œ ë‚ ì§œ (YYYY-MM-DD)")
):
    """
    í”Œë«í¼ë³„ ìˆœìœ„ ê°œì„  í†µê³„ ì¡°íšŒ
    
    Returns:
        {
            "naver": {
                "total_campaigns": 150,
                "significant_improvements": 45,
                "avg_rank_change": 38.5,
                "success_rate": 0.30
            },
            "coupang": {
                "total_campaigns": 120,
                "significant_improvements": 28,
                "avg_rank_change": 42.3,
                "success_rate": 0.23
            }
        }
    """
    pass
```

### 4.3. React ëŒ€ì‹œë³´ë“œ ì»´í¬ë„ŒíŠ¸

```typescript
// src/components/admin/RankingHistoryView.tsx
import React, { useEffect, useState } from 'react';
import { Line } from 'react-chartjs-2';
import axios from 'axios';

interface RankingHistoryPoint {
  traffic_count: number;
  rank_position: number;
  measured_at: string;
  change_detected?: {
    change: number;
    type: string;
    action: string;
  };
}

export const RankingHistoryView: React.FC<{ campaignId: string }> = ({ campaignId }) => {
  const [history, setHistory] = useState<RankingHistoryPoint[]>([]);

  useEffect(() => {
    axios.get(`/api/v1/admin/ranking/history/${campaignId}`)
      .then(res => setHistory(res.data));
  }, [campaignId]);

  const chartData = {
    labels: history.map(h => `${h.traffic_count}íšŒ`),
    datasets: [
      {
        label: 'ìˆœìœ„',
        data: history.map(h => h.rank_position),
        borderColor: 'rgb(75, 192, 192)',
        backgroundColor: 'rgba(75, 192, 192, 0.2)',
        yAxisID: 'y',
      }
    ]
  };

  const chartOptions = {
    responsive: true,
    interaction: {
      mode: 'index' as const,
      intersect: false,
    },
    scales: {
      x: {
        title: {
          display: true,
          text: 'íŠ¸ë˜í”½ ì‘ì—… íšŸìˆ˜'
        }
      },
      y: {
        type: 'linear' as const,
        display: true,
        position: 'left' as const,
        reverse: true,  // ìˆœìœ„ëŠ” ë‚®ì„ìˆ˜ë¡ ì¢‹ìœ¼ë¯€ë¡œ Yì¶• ë°˜ì „
        title: {
          display: true,
          text: 'ìˆœìœ„'
        }
      }
    },
    plugins: {
      annotation: {
        annotations: {
          line1: {
            type: 'line',
            xMin: 100,
            xMax: 100,
            borderColor: 'red',
            borderWidth: 2,
            label: {
              content: '100íšŒ ì™„ë£Œ',
              enabled: true
            }
          }
        }
      }
    }
  };

  return (
    <div className="ranking-history-view">
      <h2>ìˆœìœ„ ë³€ë™ ì´ë ¥</h2>
      <Line data={chartData} options={chartOptions} />
      
      {history.length > 0 && history[history.length - 1].change_detected && (
        <div className="change-detected-alert">
          <h3>ğŸ‰ ìœ ì˜ë¯¸í•œ ìˆœìœ„ ê°œì„  ê°ì§€!</h3>
          <p>
            ìˆœìœ„ ë³€í™”: {history[history.length - 1].change_detected.change}ìœ„ ìƒìŠ¹<br />
            íŠ¸ë˜í”½ ì‘ì—…: {history[history.length - 1].traffic_count}íšŒ ì™„ë£Œ
          </p>
        </div>
      )}
    </div>
  );
};
```

---

## 5. ğŸ”„ Control Tower í†µí•©

### 5.1. íŠ¸ë˜í”½ ì‘ì—… ì™„ë£Œ ì‹œ ìˆœìœ„ ë³€í™” ê°ì§€

```python
# server/agents/control_tower.py
from .ranking_change_detector_v2 import RankingChangeDetectorV2

class ControlTowerAgent:
    def __init__(self):
        self.detector = RankingChangeDetectorV2()
    
    async def on_traffic_task_completed(self, campaign_id: str):
        """
        íŠ¸ë˜í”½ ì‘ì—… 1íšŒ ì™„ë£Œ ì‹œ í˜¸ì¶œë˜ëŠ” ì½œë°±
        """
        # 1. ìº í˜ì¸ì˜ íŠ¸ë˜í”½ ì‘ì—… íšŸìˆ˜ ì¦ê°€
        await self.db.execute(
            "UPDATE campaigns SET traffic_count = traffic_count + 1 WHERE campaign_id = $1",
            campaign_id
        )
        
        # 2. í˜„ì¬ ìº í˜ì¸ ì •ë³´ ì¡°íšŒ
        campaign = await self.db.fetchrow(
            "SELECT * FROM campaigns WHERE campaign_id = $1",
            campaign_id
        )
        
        # 3. íŠ¸ë˜í”½ ì‘ì—… íšŸìˆ˜ê°€ 100ì˜ ë°°ìˆ˜ì¼ ë•Œë§Œ ìˆœìœ„ ì²´í¬
        if campaign["traffic_count"] % 100 == 0:
            # 3-1. ìˆœìœ„ ì²´í¬ ì‘ì—… ìƒì„±
            current_rank = await self.check_ranking(campaign_id)
            
            # 3-2. ìˆœìœ„ ë³€í™” ê°ì§€
            result = self.detector.detect_change(
                initial_rank=campaign["initial_rank"],
                current_rank=current_rank,
                traffic_count=campaign["traffic_count"]
            )
            
            # 3-3. ìœ ì˜ë¯¸í•œ ê°œì„  ê°ì§€ ì‹œ ë³€ìˆ˜ ì €ì¥
            if result["type"] == "significant":
                await self.save_significant_variables(
                    campaign_id=campaign_id,
                    ranking_change=result["change"],
                    initial_rank=campaign["initial_rank"],
                    final_rank=current_rank,
                    traffic_count=result["traffic_count"]
                )
            
            # 3-4. WebSocketìœ¼ë¡œ ê´€ë¦¬ìì—ê²Œ ì•Œë¦¼
            await self.websocket_manager.broadcast({
                "type": "ranking_change_detected",
                "campaign_id": campaign_id,
                "result": result
            })
```

---

## 6. ğŸ¯ ìµœì¢… ì •ë¦¬

### v2.0 í•µì‹¬ ë³€ê²½ ì‚¬í•­

| í•­ëª© | v1.0 | **v2.0** |
|---|---|---|
| **ìœ ì˜ë¯¸í•œ ê°œì„  ê¸°ì¤€** | ìˆœìœ„ ê°œì„  â‰¥ 1ìœ„ | **100íšŒ íŠ¸ë˜í”½ ì‘ì—… í›„ 50ìœ„ ì´ìƒ ìƒìŠ¹** |
| **íŒì • ì‹œì ** | ë§¤ ìˆœìœ„ ì²´í¬ë§ˆë‹¤ | **100íšŒ íŠ¸ë˜í”½ ì‘ì—… ì™„ë£Œ ì‹œì ** |
| **ê´€ë¦¬ì ë·°** | ì—†ìŒ | **ìˆœìœ„ ë³€ë™ ì´ë ¥ ê·¸ë˜í”„, ì§„í–‰ë¥ , í†µê³„ ì œê³µ** |
| **ë°ì´í„°ë² ì´ìŠ¤** | traffic_count ì—†ìŒ | **traffic_count ì»¬ëŸ¼ ì¶”ê°€** |

### ê¸°ëŒ€ íš¨ê³¼

1. **ë…¸ì´ì¦ˆ ì œê±°**: 1~2ìœ„ ì •ë„ì˜ ìì—° ë³€ë™ì„ 'ìœ ì˜ë¯¸í•œ ê°œì„ 'ìœ¼ë¡œ ì˜¤íŒí•˜ëŠ” ë¬¸ì œ í•´ê²°
2. **ì‹¤ìš©ì„± í–¥ìƒ**: ì‹¤ì œ ë¹„ì¦ˆë‹ˆìŠ¤ íš¨ê³¼ê°€ ìˆëŠ” 50ìœ„ ì´ìƒ ìƒìŠ¹ë§Œì„ ìœ ì˜ë¯¸í•˜ê²Œ íŒì •
3. **íˆ¬ëª…ì„± í™•ë³´**: ê´€ë¦¬ìê°€ ìˆœìœ„ ë³€ë™ ì´ë ¥ì„ ì‹¤ì‹œê°„ìœ¼ë¡œ í™•ì¸ ê°€ëŠ¥
4. **ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •**: íŠ¸ë˜í”½ ì‘ì—… íšŸìˆ˜ì™€ ìˆœìœ„ ë³€í™”ì˜ ìƒê´€ê´€ê³„ë¥¼ ëª…í™•íˆ íŒŒì•…

---

**ì‘ì„±ì**: Manus AI Agent  
**ìµœì¢… ìˆ˜ì •ì¼**: 2025-11-05  
**ë²„ì „**: 2.0
